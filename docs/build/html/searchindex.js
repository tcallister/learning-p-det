Search.setIndex({"docnames": ["diagnostics", "draw_new_injections", "format_training_data", "getData", "getting-started", "hierarchical-inference", "index", "making-figures", "modules", "population_model", "prep_injections", "training-the-network"], "filenames": ["diagnostics.rst", "draw_new_injections.rst", "format_training_data.rst", "getData.rst", "getting-started.rst", "hierarchical-inference.rst", "index.rst", "making-figures.rst", "modules.rst", "population_model.rst", "prep_injections.rst", "training-the-network.rst"], "titles": ["diagnostics module", "draw_new_injections module", "format_training_data module", "getData module", "Getting started", "Hierarchical Inference", "Welcome to learning-p-det\u2019s documentation!", "Figure generation", "Modules", "population_model module", "prep_injections module", "Training the network"], "terms": {"ks_test": 0, "ann": 0, "addderiv": 0, "feature_nam": [0, 1], "input_sc": 0, "ndraw": 0, "reference_data": 0, "population_typ": 0, "output_prefix": 0, "parameters_to_check": 0, "none": [0, 3, 9, 10], "jit": [0, 1], "fals": [0, 1], "sourc": [0, 1, 2, 3, 4, 6, 9, 10, 11], "function": [0, 1, 2, 3, 5, 6, 9, 10, 11], "us": [0, 1, 2, 3, 4, 5, 6, 10, 11], "comput": [0, 4, 5, 11], "k": [0, 11], "test": [0, 11], "statist": [0, 11], "p": [0, 4, 5, 7, 9, 11], "valu": [0, 11], "between": [0, 9, 11], "distribut": [0, 1, 9, 11], "found": [0, 1, 2, 3, 10, 11], "pipelin": [0, 5, 11], "inject": [0, 1, 2, 3, 9, 10, 11], "detect": [0, 2, 6, 9, 10, 11], "predict": [0, 1, 11], "neural": [0, 1, 2, 4, 6, 11], "network": [0, 1, 2, 4, 6], "effect": [0, 9], "wrapper": [0, 2], "draw_new_inject": [0, 8], "gen_found_inject": [0, 1], "run_network_train": [0, 11], "py": [0, 5, 11], "produc": [0, 2, 5, 6], "train": [0, 2, 5, 6, 9], "summari": [0, 11], "plot": [0, 11], "paramet": [0, 1, 2, 3, 5, 6, 9, 10, 11], "tf": [0, 1], "kera": [0, 1], "model": [0, 1, 9, 11], "sequenti": [0, 1], "func": [0, 1], "add": [0, 1, 2], "ani": [0, 1, 7], "necessari": [0, 2, 4, 6, 7, 10, 11], "deriv": [0, 1, 2], "featur": [0, 1], "list": [0, 1, 7, 11], "name": [0, 1, 2, 4, 10, 11], "expect": [0, 1], "sklearn": [0, 1, 11], "preprocess": [0, 1, 3, 10, 11], "standardscal": [0, 1, 11], "scaler": [0, 1], "appli": [0, 1], "befor": [0, 5], "pass": 0, "int": [0, 1, 3, 10], "number": [0, 1, 3, 10, 11], "event": [0, 2, 3, 9, 11], "from": [0, 1, 3, 7, 11], "target": 0, "popul": [0, 3, 4, 5, 10, 11], "str": [0, 2, 10], "filepath": [0, 2], "contain": [0, 1, 2, 3, 4, 5, 7, 9, 11], "against": 0, "which": [0, 1, 2, 4, 5, 6, 9, 10, 11], "compar": [0, 11], "string": [0, 1], "specifi": [0, 1, 11], "draw": [0, 1, 3, 5, 10], "propos": [0, 1], "see": [0, 4, 5, 7, 11], "prefix": [0, 11], "prepend": [0, 11], "save": [0, 2, 5, 7, 10, 11], "jpeg": [0, 11], "file": [0, 2, 4, 5, 7, 10, 11], "perform": [0, 4, 10], "If": [0, 1, 3, 4], "i": [0, 1, 4, 5, 6, 11], "all": [0, 2, 7], "bool": [0, 1, 3], "boolean": 0, "tell": 0, "whether": 0, "place": [0, 1, 2, 4], "tensorflow": [0, 11], "return": [0, 1, 2, 3, 9, 10], "ks_result": 0, "dict": [0, 1, 3, 9], "dictionari": [0, 1, 3, 5, 9, 11], "estim": [0, 11], "effici": [0, 11], "batch_siz": 1, "1000": 1, "min_m1": 1, "2": [1, 4], "0": [1, 4, 11], "max_m1": 1, "100": 1, "alpha_m1": 1, "35": 1, "min_m2": 1, "max_m2": 1, "alpha_m2": 1, "1": [1, 4], "max_a1": 1, "998": 1, "max_a2": 1, "zmax": 1, "9": 1, "kappa": 1, "conditional_mass": 1, "new": [1, 4, 5], "note": [1, 5], "o3b": [1, 2], "ar": [1, 6, 10, 11], "describ": [1, 9, 11], "http": [1, 4, 6, 11], "zenodo": [1, 6, 7, 11], "org": [1, 4, 6, 11], "record": [1, 11], "5546676": 1, "float": [1, 9, 10], "minimum": 1, "frame": [1, 2, 10], "primari": [1, 9, 10], "mass": [1, 3, 9, 10], "maximum": 1, "power": [1, 9], "law": [1, 9], "index": [1, 9], "secondari": [1, 10], "spin": [1, 9, 10], "magnitud": [1, 5], "redshift": [1, 10], "govern": 1, "evolut": 1, "merger": 1, "rate": [1, 5], "true": [1, 3], "normal": [1, 9], "rang": 1, "m1": [1, 9], "follow": [1, 4, 5, 11], "convent": 1, "adopt": 1, "bbh": [1, 3, 10, 11], "result": [1, 4, 5, 6, 11], "reject": 1, "sampl": [1, 3, 5, 9], "enforc": 1, "m2": 1, "bn": [1, 3, 11], "nsbh": [1, 3, 11], "o3": [1, 3, 6], "default": [1, 2, 3], "panda": [1, 2], "datafram": [1, 2], "randomli": [1, 6], "drawn": 1, "compon": [1, 10], "cartesian": [1, 10], "sky": 1, "posit": 1, "orient": 1, "distanc": 1, "time": [1, 11], "p_det_emul": 1, "addderived_func": 1, "ntotal": 1, "pop": 1, "verbos": 1, "gener": [1, 6, 11], "set": [1, 10, 11], "cbc": [1, 2, 11], "label": [1, 2, 11], "accord": 1, "our": [1, 4, 6, 7, 9, 11], "p_det": 1, "emul": [1, 5, 6, 9, 11], "annaverag": 1, "The": [1, 4, 5, 6, 7, 9, 11], "serv": [1, 11], "addit": [1, 2, 4], "requir": [1, 4, 11], "should": 1, "modifi": 1, "correspond": [1, 7], "column": 1, "nativ": 1, "ad": 1, "quantiletransform": 1, "extract": [1, 5], "total": [1, 10], "request": 1, "size": 1, "individu": [1, 11], "batch": [1, 11], "evalu": [1, 9], "each": [1, 2, 3, 9, 11], "class": [1, 11], "document": [1, 5], "user": 1, "inform": [1, 2, 11], "print": [1, 11], "screen": 1, "all_found": 1, "ntrial": [1, 10], "order": [1, 5], "yield": [1, 5], "format_and_save_certain": 2, "hfile": 2, "output": [2, 11], "read": [2, 5, 10], "format": [2, 5, 7, 10, 11], "certain": [2, 11], "dataset": [2, 6], "hdf": [2, 5, 11], "gwdistribut": 2, "reformat": 2, "annot": 2, "data": [2, 5, 6, 7, 10], "format_and_save_hopeless": 2, "hkei": 2, "hopeless": [2, 11], "format_real_injection_data": 2, "script": [2, 4, 5, 11], "load": [2, 3, 5, 11], "prepar": 2, "lvk": 2, "specif": [2, 4, 5, 6, 11], "thi": [2, 4, 5, 6, 7, 9, 11], "some": 2, "quantiti": [2, 9], "impos": 2, "select": [2, 6, 11], "cut": 2, "miss": [2, 11], "process": 2, "mark_detections_certain": 2, "injectiondata": 2, "simpl": [2, 6], "helper": 2, "object": [2, 9, 11], "read_and_annot": 2, "mark_detections_hopeless": 2, "mark": [2, 11], "given": [2, 6, 11], "h5py": 2, "open": [2, 7], "relev": 2, "insid": 2, "getinject": 3, "infer": [3, 4, 6, 9, 10], "numpyro": [3, 4, 5, 9, 10], "injectiondict": [3, 9], "associ": [3, 11], "probabl": [3, 5, 6, 9, 10, 11], "downstream": [3, 10], "hierarch": [3, 4, 6, 10], "getsampl": 3, "sample_limit": 3, "2000": 3, "bbh_onli": 3, "o3_onli": 3, "posterior": [3, 5, 9], "retain": 3, "exclud": 3, "gap": 3, "includ": [3, 11], "onli": 3, "observ": [3, 6], "run": [3, 4, 5, 6, 7, 11], "sampledict": [3, 9], "To": [4, 7, 11], "make": [4, 7], "easi": 4, "possibl": [4, 9], "reproduc": [4, 6, 7], "figur": [4, 6, 11], "yml": [4, 5, 11], "can": [4, 5, 6, 11], "build": [4, 5], "conda": [4, 5, 7, 11], "packag": 4, "need": [4, 5, 11], "code": [4, 5, 6, 11], "repositori": [4, 11], "do": [4, 11], "step": [4, 5], "sure": [4, 7], "you": [4, 5, 7, 11], "have": [4, 7, 10], "instal": [4, 11], "e": 4, "g": 4, "doc": 4, "io": 4, "en": 4, "latest": 4, "miniconda": 4, "html": 4, "env": 4, "creat": [4, 5, 11], "f": 4, "learn": [4, 5, 7, 11], "det": [4, 5, 7, 11], "activ": [4, 5, 7, 11], "deactiv": 4, "an": [4, 11], "environment_midwai": [4, 5], "similarli": 4, "midwai": 4, "gpu": [4, 5, 11], "compat": [4, 11], "jax": [4, 9], "we": [4, 5, 6, 11], "strongli": [4, 11], "recommend": [4, 11], "when": [4, 5, 11], "although": [4, 11], "suitabl": 4, "univers": [4, 5], "chicago": [4, 5], "": [4, 5], "midway3": [4, 5, 11], "cluster": [4, 5, 11], "mai": [4, 5], "work": [4, 5, 6, 11], "differ": [4, 11], "resourc": 4, "3": 4, "final": [4, 5, 11], "manual": 4, "popsummari": [4, 5], "pip": 4, "ignor": 4, "python": [4, 5, 11], "git": 4, "ligo": [4, 5, 6, 11], "christian": 4, "adamcewicz": 4, "allow": 4, "u": 4, "brute": 4, "forc": 4, "conflict": 4, "version": [4, 11], "next": 4, "releas": [4, 6, 11], "reproduct": 4, "well": [4, 5, 6, 11], "retrain": 4, "obtain": 4, "cd": [4, 5, 7, 11], "download_data_from_zenodo": 4, "sh": 4, "first": [4, 7, 11], "chang": 4, "permiss": 4, "execut": 4, "via": [4, 5, 11], "chmod": 4, "x": [4, 9, 10], "unzip": 4, "input": [4, 5, 6, 11], "directori": [4, 7, 11], "delet": 4, "zip": 4, "page": [5, 6], "detail": [5, 6, 11], "how": 5, "rerun": 5, "binari": [5, 6, 11], "black": 5, "hole": 5, "tradit": 5, "base": 5, "faster": 5, "A": [5, 6], "cuda": [5, 11], "enabl": [5, 9, 11], "environ": [5, 11], "provid": [5, 11], "your": [5, 11], "local": [5, 7], "case": 5, "like": [5, 11], "own": 5, "proceed": 5, "ll": 5, "prep_inject": [5, 8], "endo3_bbhpop": [5, 11], "t2100113": [5, 11], "v12": [5, 11], "hdf5": [5, 11], "also": 5, "injectiondict_far_1_in_1_bbh": 5, "pickl": [5, 11], "below": [5, 11], "run_standardinject": 5, "initi": 5, "baselin": [5, 9], "likelihood": [5, 11], "population_model": [5, 8], "output_standardinject": 5, "cdf": 5, "convert": [5, 9], "make_popsummary_standardinject": 5, "popsummary_standardinject": 5, "h5": 5, "hyperparamet": 5, "densiti": [5, 9, 10], "defin": [5, 9, 11], "over": 5, "grid": 5, "more": [5, 7], "info": [5, 7, 11], "handl": [5, 11], "dynam": 5, "accomplish": [5, 11], "analog": [5, 11], "run_dynamicinject": 5, "output_dynamicinject": 5, "make_popsummary_dynamicinject": 5, "popsummary_dynamicinject": 5, "present": 6, "advanc": 6, "virgo": [6, 11], "access": 6, "github": 6, "com": 6, "tcallist": [6, 11], "compris": 6, "host": 6, "doi": 6, "10": 6, "5281": 6, "13362691": 6, "In": 6, "paper": [6, 7, 11], "compact": [6, 11], "dure": 6, "successfulli": [6, 9], "occur": 6, "cours": 6, "oper": 6, "separ": 6, "pdet": [6, 9], "get": [6, 7], "start": [6, 7], "modul": 6, "jupyt": 7, "notebook": 7, "everi": 7, "appear": 7, "regener": 7, "particular": 7, "download": 7, "yourself": 7, "about": 7, "onc": 7, "ve": 7, "launch": 7, "session": 7, "Then": 7, "desir": 7, "ipynb": 7, "cell": 7, "menu": 7, "pdf": 7, "diagnost": [8, 11], "format_training_data": [8, 11], "getdata": 8, "implement": 9, "gaussian": 9, "within": [9, 11], "precomput": 9, "catalog": 9, "recov": [9, 11], "baseline_dynamicinject": 9, "injectioncdf": 9, "callabl": 9, "get_value_from_logit": 9, "logit_x": 9, "x_min": 9, "x_max": 9, "map": 9, "variabl": 9, "inf": 9, "interv": 9, "invers": 9, "logit": 9, "transform": 9, "lower": 9, "bound": 9, "upper": 9, "dlogit_dx": 9, "jacobian": 9, "divid": 9, "uniform": 9, "prior": 9, "massmodel": 9, "alpha": 9, "mu_m1": 9, "sig_m1": 9, "f_peak": 9, "mmax": 9, "mmin": 9, "dmmax": 9, "dmmin": 9, "mixtur": 9, "exponenti": 9, "taper": 9, "high": 9, "low": 9, "arrai": [9, 10, 11], "locat": 9, "peak": 9, "stanard": 9, "deviat": 9, "approxim": 9, "fraction": 9, "exact": [9, 11], "due": 9, "begin": 9, "scale": 9, "width": 9, "p_m1": 9, "numpi": [9, 10], "unnorm": 9, "truncatednorm": 9, "mu": 9, "sigma": 9, "lowcutoff": 9, "highcutoff": 9, "truncat": 9, "mean": 9, "standard": 9, "geninjectionfil": 10, "ifar_threshold": 10, "filenam": [10, 11], "analysi": 10, "ifar": 10, "threshold": 10, "year": 10, "abov": [10, 11], "consid": 10, "been": 10, "path": [10, 11], "store": [10, 11], "loadinject": 10, "subset": 10, "meet": 10, "unit": 10, "m1_det": 10, "m2_det": 10, "s1x_det": 10, "among": [10, 11], "s1y_det": 10, "y": 10, "s1z_det": 10, "z": 10, "s2x_det": 10, "s2y_det": 10, "s2z_det": 10, "z_det": 10, "precomputed_p_m1m2z": 10, "here": 11, "workflow": 11, "endo3_bnspop": 11, "endo3_nsbhpop": 11, "campaign": 11, "were": 11, "kagra": 11, "collabor": 11, "7890437": 11, "training_data": 11, "rpo3": 11, "meanwhil": 11, "These": 11, "pars": 11, "bbh_training_data": 11, "bbh_validation_data": 11, "reserv": 11, "valid": 11, "purpos": 11, "bns_training_data": 11, "bns_validation_data": 11, "nsbh_training_data": 11, "nsbh_validation_data": 11, "themselv": 11, "downsampl": 11, "concaten": 11, "load_training_data": 11, "util": 11, "automat": 11, "intern": 11, "rest": 11, "flow": 11, "after": 11, "itself": 11, "up": 11, "infrastructur": 11, "postprocess": 11, "It": 11, "command": 11, "line": 11, "outputprefix": 11, "runprefix_": 11, "kei": 11, "11": 11, "argument": 11, "togeth": 11, "second": 11, "integ": 11, "rng": 11, "turn": 11, "librari": 11, "experi": 11, "highli": 11, "platform": 11, "etc": 11, "depend": 11, "As": 11, "ensembl": 11, "best": 11, "straightforward": 11, "task": 11, "manag": 11, "system": 11, "slurm": 11, "exampl": 11, "show": 11, "content": 11, "uchicago": 11, "bin": 11, "bash": 11, "sbatch": 11, "job": 11, "account": 11, "kicp": 11, "project": 11, "trained_model": 11, "log": 11, "log_": 11, "a_": 11, "out": 11, "error": 11, "err": 11, "19": 11, "4": 11, "14": 11, "00": 11, "partit": 11, "ntask": 11, "mem": 11, "8g": 11, "echo": 11, "my": 11, "slurm_array_task_id": 11, "output_dir": 11, "mkdir": 11, "append": 11, "form": 11, "output_file_prefix": 11, "job_": 11, "printf": 11, "02d": 11, "home": 11, "take": 11, "few": 11, "hour": 11, "domin": 11, "extra": 11, "penal": 11, "integr": 11, "text": 11, "l": 11, "outputprefix_bbh_chirp_mass_detector": 11, "outputprefix_bbh_cos_inclin": 11, "outputprefix_bbh_log_d": 11, "outputprefix_bns_chirp_mass_detector": 11, "outputprefix_nsbh_chirp_mass_detector": 11, "outputprefix_input_scal": 11, "outputprefix_k": 11, "json": 11, "outputprefix_weight": 11, "input_scal": 11, "condit": 11, "qualiti": 11, "four": 11, "top": 11, "level": 11, "alt_pop_1": 11, "refer": 11, "three": 11, "trace": 11, "piplin": 11, "last": 11, "plausibli": 11, "astrophys": 11, "sub": 11, "entri": 11, "give": 11, "those": 11, "same": 11, "uncertainti": 11, "weight": 11, "bias": 11}, "objects": {"": [[0, 0, 0, "-", "diagnostics"], [1, 0, 0, "-", "draw_new_injections"], [2, 0, 0, "-", "format_training_data"], [3, 0, 0, "-", "getData"], [9, 0, 0, "-", "population_model"], [10, 0, 0, "-", "prep_injections"]], "diagnostics": [[0, 1, 1, "", "ks_test"]], "draw_new_injections": [[1, 1, 1, "", "draw_new_injections"], [1, 1, 1, "", "gen_found_injections"]], "format_training_data": [[2, 1, 1, "", "format_and_save_certain"], [2, 1, 1, "", "format_and_save_hopeless"], [2, 1, 1, "", "format_real_injection_data"], [2, 1, 1, "", "mark_detections_certain"], [2, 1, 1, "", "mark_detections_hopeless"], [2, 1, 1, "", "read_and_annotate"]], "getData": [[3, 1, 1, "", "getInjections"], [3, 1, 1, "", "getSamples"]], "population_model": [[9, 1, 1, "", "baseline"], [9, 1, 1, "", "baseline_dynamicInjections"], [9, 1, 1, "", "get_value_from_logit"], [9, 1, 1, "", "massModel"], [9, 1, 1, "", "truncatedNormal"]], "prep_injections": [[10, 1, 1, "", "genInjectionFile"], [10, 1, 1, "", "loadInjections"]]}, "objtypes": {"0": "py:module", "1": "py:function"}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "function", "Python function"]}, "titleterms": {"diagnost": 0, "modul": [0, 1, 2, 3, 8, 9, 10], "draw_new_inject": 1, "format_training_data": 2, "getdata": 3, "get": 4, "start": 4, "set": 4, "up": 4, "your": 4, "environ": 4, "download": 4, "data": [4, 11], "from": 4, "zenodo": 4, "hierarch": 5, "infer": 5, "1": [5, 11], "prepar": [5, 11], "inject": 5, "2": [5, 11], "standard": 5, "select": 5, "effect": 5, "3": 5, "neural": 5, "network": [5, 11], "welcom": 6, "learn": 6, "p": 6, "det": 6, "": 6, "document": 6, "content": 6, "figur": 7, "gener": 7, "population_model": 9, "prep_inject": 10, "train": 11, "perform": 11}, "envversion": {"sphinx.domains.c": 3, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 9, "sphinx.domains.index": 1, "sphinx.domains.javascript": 3, "sphinx.domains.math": 2, "sphinx.domains.python": 4, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.viewcode": 1, "sphinx": 58}, "alltitles": {"diagnostics module": [[0, "module-diagnostics"]], "draw_new_injections module": [[1, "module-draw_new_injections"]], "format_training_data module": [[2, "module-format_training_data"]], "getData module": [[3, "module-getData"]], "Getting started": [[4, "getting-started"]], "Setting up your environment": [[4, "setting-up-your-environment"]], "Download data from Zenodo": [[4, "download-data-from-zenodo"]], "Hierarchical Inference": [[5, "hierarchical-inference"]], "1. Preparing injections": [[5, "preparing-injections"]], "2. Standard Selection Effects": [[5, "standard-selection-effects"]], "3. Neural Network Selection Effects": [[5, "neural-network-selection-effects"]], "Welcome to learning-p-det\u2019s documentation!": [[6, "welcome-to-learning-p-det-s-documentation"]], "Contents:": [[6, null]], "Figure generation": [[7, "figure-generation"]], "Modules": [[8, "modules"]], "population_model module": [[9, "module-population_model"]], "prep_injections module": [[10, "module-prep_injections"]], "Training the network": [[11, "training-the-network"]], "1. Preparing training data": [[11, "preparing-training-data"]], "2. Perform training": [[11, "perform-training"]]}, "indexentries": {"diagnostics": [[0, "module-diagnostics"]], "ks_test() (in module diagnostics)": [[0, "diagnostics.ks_test"]], "module": [[0, "module-diagnostics"], [1, "module-draw_new_injections"], [2, "module-format_training_data"], [3, "module-getData"], [9, "module-population_model"], [10, "module-prep_injections"]], "draw_new_injections": [[1, "module-draw_new_injections"]], "draw_new_injections() (in module draw_new_injections)": [[1, "draw_new_injections.draw_new_injections"]], "gen_found_injections() (in module draw_new_injections)": [[1, "draw_new_injections.gen_found_injections"]], "format_and_save_certain() (in module format_training_data)": [[2, "format_training_data.format_and_save_certain"]], "format_and_save_hopeless() (in module format_training_data)": [[2, "format_training_data.format_and_save_hopeless"]], "format_real_injection_data() (in module format_training_data)": [[2, "format_training_data.format_real_injection_data"]], "format_training_data": [[2, "module-format_training_data"]], "mark_detections_certain() (in module format_training_data)": [[2, "format_training_data.mark_detections_certain"]], "mark_detections_hopeless() (in module format_training_data)": [[2, "format_training_data.mark_detections_hopeless"]], "read_and_annotate() (in module format_training_data)": [[2, "format_training_data.read_and_annotate"]], "getdata": [[3, "module-getData"]], "getinjections() (in module getdata)": [[3, "getData.getInjections"]], "getsamples() (in module getdata)": [[3, "getData.getSamples"]], "baseline() (in module population_model)": [[9, "population_model.baseline"]], "baseline_dynamicinjections() (in module population_model)": [[9, "population_model.baseline_dynamicInjections"]], "get_value_from_logit() (in module population_model)": [[9, "population_model.get_value_from_logit"]], "massmodel() (in module population_model)": [[9, "population_model.massModel"]], "population_model": [[9, "module-population_model"]], "truncatednormal() (in module population_model)": [[9, "population_model.truncatedNormal"]], "geninjectionfile() (in module prep_injections)": [[10, "prep_injections.genInjectionFile"]], "loadinjections() (in module prep_injections)": [[10, "prep_injections.loadInjections"]], "prep_injections": [[10, "module-prep_injections"]]}})